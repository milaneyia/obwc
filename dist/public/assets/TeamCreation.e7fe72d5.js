var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;import{d as o,m as n,b as c,o as d,c as u,a as m,t as h,n as p,D as v,F as b,r as f,g as y,e as g,i as w}from"./vendor.437caaf2.js";import{C}from"./index.d9c9ff1c.js";import{_ as x}from"./ModeButton.58176beb.js";var U,k,O=o({components:{ModeButton:x},data:()=>({filter:"",name:"",openContests:[],users:[],selectedUsers:[],acceptedUsers:[],selectedContest:null,loading:!1}),computed:(U=((e,s)=>{for(var t in s||(s={}))i.call(s,t)&&r(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&r(e,t,s[t]);return e})({},n({user:e=>e.loggedInUser,contests:e=>e.contests})),k={filteredUsers(){return this.users.filter((e=>e.username.toLowerCase().includes(this.filter.toLowerCase())))}},s(U,t(k))),async created(){const{data:e}=await this.$http.get("/api/contests/open");this.openContests=e,e.length&&await this.selectContest(e[0])},methods:{select(e){if(this.acceptedUsers.some((s=>s.id===e.id)))return;const s=this.selectedUsers.findIndex((s=>s.id===e.id));-1!==s?this.selectedUsers.splice(s,1):this.selectedUsers.push(e)},selectedClass(e){return this.acceptedUsers.some((s=>s.id===e.id))?"bg-primary text-dark border-primary cursor-default":this.selectedUsers.some((s=>s.id===e.id))?"bg-yellow text-dark border-yellow":"border-purple"},getContestIcon(e){let s="btn-mode-radio--";switch(e){case C.Standard:return s+"osu";case C.Taiko:return s+"taiko";case C.Catch:return s+"catch";case C.Mania:return s+"mania"}},async selectContest(e){this.selectedContest=e;const[{data:s},{data:t}]=await Promise.all([this.$http.get("/api/users?country="+this.user.country.id),this.$http.get(`/api/contests/${this.selectedContest.id}/teams/mine`)]);t?(this.name=t.name,this.selectedUsers=[...t.invitations,...t.users.filter((e=>!t.invitations.some((s=>s.id===e.id))))],this.acceptedUsers=t.users,this.users=[...s,...t.users]):this.users=s},save(){if(this.selectedUsers.length<2||this.selectedUsers.length>5)return this.$store.dispatch("addToastMessage","Number of members needs to be between 2 and 5");if(!this.selectedContest)return this.$store.dispatch("addToastMessage","Select a contest to participate on");this.loading=!0;const e={name:this.name,invitations:this.selectedUsers,contest:this.selectedContest};this.$http.post("/api/teams",e).finally((()=>this.loading=!1))}}});const j={class:"container-fluid"},T={class:"card card-section"},$=m("div",{class:"card-header"},[m("div",{class:"card-header-back"}," Team Creation "),m("div",{class:"card-header-sub"},[m("div",{class:"card-header-title"}," TEAM CREATION ")])],-1),E={class:"card-body"},M={class:"row"},I={class:"col-md-6"},P={class:"border-bottom"},S=g(" CREATE YOUR TEAM FOR "),A={class:"text-yellow"},R=w('<div class="row"><div class="col-sm"><ul class="card-text"><li class="text-yellow"> Only the captain should do this. </li><li>You must choose between 2 to 5 mappers.</li><li>This lists all users registered for your country since last edition of this tournament, if you don&#39;t find a specific person it&#39;s likely that they have not logged in yet.</li><li>Once submitted, selected users need to confirm by accepting your invitation (they will recieve a notification when logged in).</li><li>Staff will finalize your registration once everyone accepted their invitation and the team&#39;s name is approved.</li><li>Be careful, users are <span class="text-yellow">locked</span> once they accept their invitation! However, captains are able to cancel invitations before they get accepted.</li><li>Captains can change your team name before registration phase is over.</li><li>Users that accepted your invitation are marked as <span class="text-primary">blue</span>.</li><li>Choose responsibly.</li></ul></div></div>',1),B={class:"row my-3 g-2"},V={class:"col-lg-4"},D={class:"row"},F=m("label",{class:"col-sm-3 col-form-label text-end"},"team name",-1),L={class:"col-sm-9"},N={class:"col-lg-4"},Y={class:"row"},z=m("label",{class:"col-sm-3 col-form-label text-end"},"mode",-1),H={class:"col-sm-9"},_={class:"col-lg-4 text-end"},q=m("i",{class:"fas fa-save"},null,-1),G=g(" SAVE "),J={class:"row my-3 g-2"},K={class:"col-lg-4"},Q={class:"row"},W=m("label",{class:"col-sm-3 col-form-label text-end"},"search",-1),X={class:"col-sm-9"},Z={class:"row g-4 justify-content-center justify-content-sm-start"},ee={class:"mt-5 w-100 text-center"};O.render=function(e,s,t,a,i,l){const r=c("mode-button");return d(),u("div",j,[m("div",T,[$,m("div",E,[m("div",M,[m("div",I,[m("h4",P,[S,m("span",A,h(e.user.country.name),1)])])]),R,m("div",B,[m("div",V,[m("div",D,[F,m("div",L,[p(m("input",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.name=s),type:"text",class:"form-control text-end",maxlength:"16",placeholder:"maximum 16 characters"},null,512),[[v,e.name]])])])]),m("div",N,[m("div",Y,[z,m("div",H,[(d(!0),u(b,null,f(e.contests,(t=>{var a;return d(),u(r,{key:t.id,contest:t,disabled:!e.openContests.some((e=>e.id===t.id)),selected:(null==(a=e.selectedContest)?void 0:a.id)===t.id,onChangeSelected:s[2]||(s[2]=s=>e.selectContest(s))},null,8,["contest","disabled","selected"])})),128))])])]),m("div",_,[m("button",{class:"btn btn-yellow btn-primary px-5 fw-bold",disabled:e.loading,onClick:s[3]||(s[3]=(...s)=>e.save&&e.save(...s))},[q,G],8,["disabled"])])]),m("div",J,[m("div",K,[m("div",Q,[W,m("div",X,[p(m("input",{"onUpdate:modelValue":s[4]||(s[4]=s=>e.filter=s),type:"text",class:"form-control text-end w-100",placeholder:"filter by username"},null,512),[[v,e.filter]])])])])]),m("div",Z,[(d(!0),u(b,null,f(e.filteredUsers,(s=>(d(),u("div",{key:s.id,class:"card-user-container",onClick:y((t=>e.select(s)),["prevent"])},[m("div",{class:["card card-body justify-content-center align-items-center h-100 card-user",e.selectedClass(s)]},[m("div",{class:"avatar avatar--large",style:`background-image: url(https://a.ppy.sh/${s.osuId})`},null,4),m("div",ee,h(s.username),1)],2)],8,["onClick"])))),128))])])])])};export default O;
