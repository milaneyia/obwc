var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;import{d as o,m as n,o as c,c as d,a as u,t as m,l as p,A as h,F as v,r as b,B as f,g as y,e as g,i as w}from"./vendor.6e598276.js";import{C}from"./index.793ba953.js";var x,U,k=o({data:()=>({filter:"",name:"",openContests:[],users:[],selectedUsers:[],acceptedUsers:[],selectedContest:null,loading:!1}),computed:(x=((e,s)=>{for(var t in s||(s={}))i.call(s,t)&&r(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&r(e,t,s[t]);return e})({},n({user:e=>e.loggedInUser,contests:e=>e.contests})),U={filteredUsers(){return this.users.filter((e=>e.username.toLowerCase().includes(this.filter.toLowerCase())))}},s(x,t(U))),async created(){const[{data:e},{data:s},{data:t}]=await Promise.all([this.$http.get("/api/contests/open"),this.$http.get("/api/users?country="+this.user.country.id),this.$http.get("/api/teams/mine")]);this.openContests=e,e.length&&(this.selectedContest=e[0]),t?(this.name=t.name,this.selectedContest=t.contest,this.selectedUsers=[...t.invitations,...t.users.filter((e=>!t.invitations.some((s=>s.id===e.id))))],this.acceptedUsers=t.users,this.users=[...s,...t.users]):this.users=s},methods:{select(e){if(this.acceptedUsers.some((s=>s.id===e.id)))return;const s=this.selectedUsers.findIndex((s=>s.id===e.id));-1!==s?this.selectedUsers.splice(s,1):this.selectedUsers.push(e)},selectedClass(e){return this.acceptedUsers.some((s=>s.id===e.id))?"bg-primary text-dark border-primary cursor-default":this.selectedUsers.some((s=>s.id===e.id))?"bg-yellow text-dark border-yellow":"border-purple"},getContestIcon(e){let s="btn-mode-radio--";switch(e){case C.Standard:return s+"osu";case C.Taiko:return s+"taiko";case C.Catch:return s+"catch";case C.Mania:return s+"mania"}},save(){if(this.selectedUsers.length<2||this.selectedUsers.length>5)return this.$store.dispatch("addToastMessage","Number of members needs to be between 2 and 5");if(!this.selectedContest)return this.$store.dispatch("addToastMessage","Select a contest to participate on");this.loading=!0;const e={name:this.name,invitations:this.selectedUsers,contest:this.selectedContest};this.$http.post("/api/teams",e).finally((()=>this.loading=!1))}}});const O={class:"container-fluid"},j={class:"card card-section"},T=u("div",{class:"card-header"},[u("div",{class:"card-header-back"}," Team Creation "),u("div",{class:"card-header-sub"},[u("div",{class:"card-header-title"}," TEAM CREATION ")])],-1),E={class:"card-body"},I={class:"row"},$={class:"col-md-6"},A={class:"border-bottom"},P=g(" CREATE YOUR TEAM FOR "),M={class:"text-yellow"},S=w('<div class="row"><div class="col-sm"><ul class="card-text"><li class="text-yellow"> Only the captain should do this. </li><li>You must choose between 2 to 5 mappers.</li><li>This lists all users registered for your country since last edition of this tournament, if you don&#39;t find a specific person it&#39;s likely that they have not logged in yet.</li><li>Once submitted, selected users need to confirm by accepting your invitation (they will recieve a notification when logged in).</li><li>Staff will finalize your registration once everyone accepted their invitation and the team&#39;s name is approved.</li><li>Be careful, users are <span class="text-yellow">locked</span> once they accept their invitation! However, captains are able to cancel invitations before they get accepted.</li><li>Captains can change your team name before registration phase is over.</li><li>Users that accepted your invitation are marked as <span class="text-primary">blue</span>.</li><li>Choose responsibly.</li></ul></div></div>',1),R={class:"row my-3 g-2"},V={class:"col-lg-4"},B={class:"row"},F=u("label",{class:"col-sm-3 col-form-label text-end"},"team name",-1),L={class:"col-sm-9"},N={class:"col-lg-4"},Y={class:"row"},z=u("label",{class:"col-sm-3 col-form-label text-end"},"mode",-1),D={class:"col-sm-9"},H={class:"col-lg-4 text-end"},q=u("i",{class:"fas fa-save"},null,-1),G=g(" SAVE "),J={class:"row my-3 g-2"},K={class:"col-lg-4"},Q={class:"row"},W=u("label",{class:"col-sm-3 col-form-label text-end"},"search",-1),X={class:"col-sm-9"},Z={class:"row g-4 justify-content-center justify-content-sm-start"},_={class:"mt-5 w-100 text-center"};k.render=function(e,s,t,a,i,l){return c(),d("div",O,[u("div",j,[T,u("div",E,[u("div",I,[u("div",$,[u("h4",A,[P,u("span",M,m(e.user.country.name),1)])])]),S,u("div",R,[u("div",V,[u("div",B,[F,u("div",L,[p(u("input",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.name=s),type:"text",class:"form-control text-end",maxlength:"16",placeholder:"maximum 16 characters"},null,512),[[h,e.name]])])])]),u("div",N,[u("div",Y,[z,u("div",D,[(c(!0),d(v,null,b(e.contests,(t=>{var a;return c(),d(v,{key:t.id},[p(u("input",{id:"mode-"+t.id,"onUpdate:modelValue":s[2]||(s[2]=s=>e.selectedContest=s),type:"radio",class:"btn-check",autocomplete:"off",value:t,disabled:!e.openContests.some((e=>e.id===t.id))},null,8,["id","value","disabled"]),[[f,e.selectedContest]]),u("label",{class:["btn btn-mode-radio me-2",[(null==(a=e.selectedContest)?void 0:a.id)===t.id?"active":"",e.getContestIcon(t.id)]],for:"mode-"+t.id},null,10,["for"])],64)})),128))])])]),u("div",H,[u("button",{class:"btn btn-yellow btn-primary px-5 fw-bold",disabled:e.loading,onClick:s[3]||(s[3]=(...s)=>e.save&&e.save(...s))},[q,G],8,["disabled"])])]),u("div",J,[u("div",K,[u("div",Q,[W,u("div",X,[p(u("input",{"onUpdate:modelValue":s[4]||(s[4]=s=>e.filter=s),type:"text",class:"form-control text-end w-100",placeholder:"filter by username"},null,512),[[h,e.filter]])])])])]),u("div",Z,[(c(!0),d(v,null,b(e.filteredUsers,(s=>(c(),d("div",{key:s.id,class:"card-user-container",onClick:y((t=>e.select(s)),["prevent"])},[u("div",{class:["card card-body justify-content-center align-items-center h-100 card-user",e.selectedClass(s)]},[u("div",{class:"avatar avatar--large",style:`background-image: url(https://a.ppy.sh/${s.osuId})`},null,4),u("div",_,m(s.username),1)],2)],8,["onClick"])))),128))])])])])};export default k;
